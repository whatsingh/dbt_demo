version: 2

sources:
  - name: bike_rides
    database: bigquery-public-data
    description: 'data showing bike ride usage'
    schema: austin_bikeshare
    tables:
      - name: bikeshare_stations
        description: 'This table talks about the bike stations'
      - name: bikeshare_trips
        description: 'This table talks about the actual rides/riders'

models:
   
  - name: stg_rider
    columns:
      - name: trip_id
        tests:
          - not_null
          - unique
          - dbt_utils.at_least_one
  - name: stg_station
    columns:
      - name: station_id
        description: 'where the bike was picked up'
        tests:
          - not_null
          - unique
          - dbt_utils.not_constant

      - name: status
        tests:
          - not_null
          - accepted_values:
             values: 
             - closed
             - active
      - name: name
        tests:
          - dbt_utils.not_accepted_values:
              values: ['Waller & 6th St.']
         
      - name: alternate_name        
        tests:
          - dbt_utils.not_null_proportion:
              at_least: 0.02
      - name: modified_date       
        tests:
          - dbt_utils.expression_is_true:
              config:
                where: "modified_date > '2021-01-01T12:00:00+00:00'"